<?xml version="1.0" encoding="UTF-8"?>
<pd:ProcessDefinition xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:pfx="http://www.tibco.com/schemas/MobCastleAD1006RemoteReport_JSON/FrontJSONUI/Level1/Schema.xsd" xmlns:pd="http://xmlns.tibco.com/bw/process/2003" xmlns:pfx2="http://www.tibco.com/ns/no_namespace_schema_location/FrontJSONUI/Level2/CSVFormat.sharedparse" xmlns:ns="http://www.tibco.com/pe/EngineTypes" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:tib="http://www.tibco.com/bw/xslt/custom-functions" xmlns:ns2="http://www.tibco.com/pe/DeployedVarsType" xmlns:ns1="http://www.tibco.com/namespaces/tnt/plugins/file/v2" xmlns:ns4="http://www.tibco.com/namespaces/tnt/plugins/json" xmlns:ns3="http://www.tibco.com/namespaces/tnt/plugins/file">
    <xsd:import namespace="http://www.tibco.com/ns/no_namespace_schema_location/FrontJSONUI/Level2/CSVFormat.sharedparse" schemaLocation="/FrontJSONUI/Level2/CSVFormat.sharedparse"/>
    <xsd:import namespace="http://www.tibco.com/schemas/MobCastleAD1006RemoteReport_JSON/FrontJSONUI/Level1/Schema.xsd" schemaLocation="/FrontJSONUI/Level1/AllJSONSchema.xsd"/>
    <pd:name>FrontJSONUI/Level2/report_robert.process</pd:name>
    <pd:startName>Start</pd:startName>
    <pd:startType ref="pfx:AllJSONRequests"/>
    <pd:startX>80</pd:startX>
    <pd:startY>64</pd:startY>
    <pd:returnBindings>
        <pfx:SubEnd>
            <pfx:JSONResponse>
                <xsl:value-of select="concat(&#xA;$FormatReportResponse/root/formatReport,&#xA;$JSON_AllResponse/ns4:ActivityOutputClass/jsonString&#xA;)"/>
            </pfx:JSONResponse>
        </pfx:SubEnd>
    </pd:returnBindings>
    <pd:endName>End</pd:endName>
    <pd:endType ref="pfx:SubEnd"/>
    <pd:endX>711</pd:endX>
    <pd:endY>194</pd:endY>
    <pd:errorSchemas/>
    <pd:processVariables/>
    <pd:targetNamespace>http://xmlns.example.com/1478154485942</pd:targetNamespace>
    <pd:activity name="offer_query">
        <pd:type>com.tibco.plugin.jdbc.JDBCGeneralActivity</pd:type>
        <pd:resourceType>ae.activities.JDBCGeneralActivity</pd:resourceType>
        <pd:description>concat("select ",$e/tableName,"_id,",$e/tableName,"_name,",$e/tableName,"_status from ",$e/tableName," where ",$e/tableName,"_id like '%",$SearchAllTables/ProcessStarterOutput/parameters/searchValue,"%' or ",$e/tableName,"_name like '%",$SearchAllTables/ProcessStarterOutput/parameters/searchValue,"%'")</pd:description>
        <pd:x>81</pd:x>
        <pd:y>196</pd:y>
        <config>
            <timeout>10</timeout>
            <commit>false</commit>
            <maxRows>100</maxRows>
            <jdbcSharedConfig>/0920UpdateTables/MySql.sharedjdbc</jdbcSharedConfig>
        </config>
        <pd:inputBindings>
            <jdbcGeneralActivityInput>
                <statement>
                    <xsl:value-of select="concat(&#xA;&quot;select * from view_label_offer_status_notpause &quot;,&#xA;&quot;where offer_id like '%&quot;,&#xA;$Start/pfx:AllJSONRequests/pfx:searchvalue,&#xA;&quot;%' or offer_name like '%&quot;,&#xA;$Start/pfx:AllJSONRequests/pfx:searchvalue,&#xA;&quot;%'&quot;)"/>
                </statement>
            </jdbcGeneralActivityInput>
        </pd:inputBindings>
    </pd:activity>
    <pd:activity name="n_query">
        <pd:type>com.tibco.plugin.jdbc.JDBCGeneralActivity</pd:type>
        <pd:resourceType>ae.activities.JDBCGeneralActivity</pd:resourceType>
        <pd:x>202</pd:x>
        <pd:y>196</pd:y>
        <config>
            <timeout>10</timeout>
            <commit>false</commit>
            <maxRows>100</maxRows>
            <jdbcSharedConfig>/0920UpdateTables/MySql.sharedjdbc</jdbcSharedConfig>
        </config>
        <pd:inputBindings>
            <jdbcGeneralActivityInput>
                <statement>
                    <xsl:value-of select="concat(&quot;select * from view_label_n_status_notpause where n_id like '%&quot;,&#xA;$Start/pfx:AllJSONRequests/pfx:searchvalue,&#xA;&quot;%' or n_name like '%&quot;,&#xA;$Start/pfx:AllJSONRequests/pfx:searchvalue,&#xA;&quot;%'&quot;)"/>
                </statement>
            </jdbcGeneralActivityInput>
        </pd:inputBindings>
    </pd:activity>
    <pd:activity name="SaveConcat">
        <pd:type>com.tibco.plugin.mapper.MapperActivity</pd:type>
        <pd:resourceType>ae.activities.MapperActivity</pd:resourceType>
        <pd:x>202</pd:x>
        <pd:y>65</pd:y>
        <config>
            <element>
                <xsd:element name="root">
                    <xsd:complexType>
                        <xsd:sequence>
                            <xsd:element name="offer" type="xsd:string" minOccurs="0"/>
                            <xsd:element name="n" type="xsd:string" minOccurs="0"/>
                            <xsd:element name="startdate" type="xsd:string" minOccurs="0"/>
                            <xsd:element name="enddate" type="xsd:string" minOccurs="0"/>
                        </xsd:sequence>
                    </xsd:complexType>
                </xsd:element>
            </element>
        </config>
        <pd:inputBindings>
            <root>
                <offer>
                    <xsl:value-of select="tib:concat-sequence-format(for $row in $offer_query/jdbcGeneralActivityOutput/unknownResultset/row return tib:concat-sequence-format($row/column/value, &quot;-&quot;), &quot;,&quot;)"/>
                </offer>
                <n>
                    <xsl:value-of select="tib:concat-sequence-format(for $row in $n_query/jdbcGeneralActivityOutput/unknownResultset/row return tib:concat-sequence-format($row/column/value, &quot;-&quot;), &quot;,&quot;)"/>
                </n>
                <xsl:choose>
                    <xsl:when test="$Start/pfx:AllJSONRequests/pfx:enddate!=&quot;&quot;">
                        <xsl:if test="$Start/pfx:AllJSONRequests/pfx:enddate">
                            <startdate>
                                <xsl:value-of select="$Start/pfx:AllJSONRequests/pfx:enddate"/>
                            </startdate>
                        </xsl:if>
                    </xsl:when>
                    <xsl:otherwise>
                        <startdate>
                            <xsl:value-of select="substring-before(current-date(), &quot;+&quot;)"/>
                        </startdate>
                    </xsl:otherwise>
                </xsl:choose>
                <xsl:choose xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
                    <xsl:when test="$Start/pfx:AllJSONRequests/pfx:enddate=&quot;&quot;">
                        <enddate>
                            <xsl:value-of select="substring-before(current-date(), &quot;+&quot;)"/>
                        </enddate>
                    </xsl:when>
                    <xsl:otherwise>
                        <xsl:if test="$Start/pfx:AllJSONRequests/pfx:enddate">
                            <enddate>
                                <xsl:value-of select="$Start/pfx:AllJSONRequests/pfx:enddate"/>
                            </enddate>
                        </xsl:if>
                    </xsl:otherwise>
                </xsl:choose>
            </root>
        </pd:inputBindings>
    </pd:activity>
    <pd:activity name="External Command">
        <pd:type>com.tibco.plugin.cmdexec.CmdExecActivity</pd:type>
        <pd:resourceType>ae.activities.CmdExecActivity</pd:resourceType>
        <pd:x>329</pd:x>
        <pd:y>68</pd:y>
        <config>
            <outputToString>true</outputToString>
            <lineSplit>None</lineSplit>
        </config>
        <pd:inputBindings>
            <CmdInput>
                <command>
                    <xsl:value-of select="concat(&quot;python report_merge.py &quot;,&#xA;$SaveConcat/root/startdate,&#xA;&quot; &quot;,&#xA;$SaveConcat/root/enddate,&#xA;&quot; &quot;,&#xA;$Start/pfx:AllJSONRequests/pfx:accuracy,&#xA;&quot; &quot;,&#xA;$SaveConcat/root/offer,&#xA;&quot; &quot;,&#xA;$SaveConcat/root/n,&#xA;&quot; &quot;,&#xA;$_processContext/ns:ProcessContext/ProcessId&#xA; )"/>
                </command>
                <workingDirectory>
                    <xsl:value-of select="&quot;E:\SoftWares\Project\log\&quot;"/>
                </workingDirectory>
            </CmdInput>
        </pd:inputBindings>
    </pd:activity>
    <pd:activity name="Read File">
        <pd:type>com.tibco.plugin.file.FileReadActivity</pd:type>
        <pd:resourceType>ae.activities.FileReadActivity</pd:resourceType>
        <pd:description>the csv is not utf-8 encoded</pd:description>
        <pd:x>329</pd:x>
        <pd:y>188</pd:y>
        <config>
            <encoding>text</encoding>
        </config>
        <pd:inputBindings>
            <ns1:ReadActivityInputClass>
                <fileName>
                    <xsl:value-of select="&quot;F:\GeekWorkLearn\MyFootPrint\QQFiles\Projects\report_7267443.csv&quot;"/>
                </fileName>
            </ns1:ReadActivityInputClass>
        </pd:inputBindings>
    </pd:activity>
    <pd:activity name="FormatReportResponse">
        <pd:type>com.tibco.plugin.mapper.MapperActivity</pd:type>
        <pd:resourceType>ae.activities.MapperActivity</pd:resourceType>
        <pd:x>568</pd:x>
        <pd:y>193</pd:y>
        <config>
            <element>
                <xsd:element name="root">
                    <xsd:complexType>
                        <xsd:sequence>
                            <xsd:element name="formatReport" type="xsd:string" minOccurs="0"/>
                        </xsd:sequence>
                    </xsd:complexType>
                </xsd:element>
            </element>
        </config>
        <pd:inputBindings>
            <root>
                <formatReport>
                    <xsl:value-of select="concat(&#xA;$ReportCSS/ns3:ReadActivityOutputTextClass/fileContent/textContent,&#xA;&quot;&lt;tr>&lt;td>&quot;,&#xA;tib:substring-before-last($Java-Code/javaCodeActivityOutput/out, &quot;&lt;tr>&quot;), &#xA;&quot;&lt;/table>&quot;,&#xA;$DownloadReport/ns3:ReadActivityOutputTextClass/fileContent/textContent,&#xA;&quot;&lt;a href=http://60.205.189.32:9990/downloadreport?reportname=&quot;,&#xA;$Read-File/ns3:ReadActivityOutputTextClass/fileInfo/fullName,&#xA;&quot; name=report.csv>download Report Process&lt;/a> &lt;/body>&lt;/html>&quot;&#xA;)"/>
                </formatReport>
            </root>
        </pd:inputBindings>
    </pd:activity>
    <pd:activity name="Java Code">
        <pd:type>com.tibco.plugin.java.JavaActivity</pd:type>
        <pd:resourceType>ae.javapalette.javaActivity</pd:resourceType>
        <pd:x>434</pd:x>
        <pd:y>192</pd:y>
        <config>
            <fileName>report_robertJavaCode</fileName>
            <packageName>FrontJSONUI.Level2.report_robert</packageName>
            <fullsource>package FrontJSONUI.Level2.report_robert;
import java.util.*;
import java.io.*;
public class report_robertJavaCode{
/****** START SET/GET METHOD, DO NOT MODIFY *****/
	protected String in = "";
	protected String out = "";
	protected String[] out_json = null;
	public String getin() {
		return in;
	}
	public void setin(String val) {
		in = val;
	}
	public String getout() {
		return out;
	}
	public void setout(String val) {
		out = val;
	}
	public String[] getout_json() {
		return out_json;
	}
	public void setout_json(String[] val) {
		out_json = val;
	}
/****** END SET/GET METHOD, DO NOT MODIFY *****/
	public report_robertJavaCode() {
	}
	public void invoke() throws Exception {
/* Available Variables: DO NOT MODIFY
	In  : String in
	Out : String out
	Out : String[] out_json
* Available Variables: DO NOT MODIFY *****/

out=in.replaceAll("\n","&lt;p&gt;");
out=out.replaceAll("&lt;p&gt;","&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;");
out=out.replaceAll(",","&lt;/td&gt;&lt;td&gt;");
}
}
</fullsource>
            <inputData>
                <row>
                    <fieldName>in</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>optional</fieldRequired>
                </row>
            </inputData>
            <outputData>
                <row>
                    <fieldName>out</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>optional</fieldRequired>
                </row>
                <row>
                    <fieldName>out_json</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>repeating</fieldRequired>
                </row>
            </outputData>
            <byteCode>
                <class>
                    <name>report_robertJavaCode</name>
                    <byteCode>yv66vgAAADQAOAkADAAmCQAMACcJAAwAKAoADQApCAAqCAArCAAsCgAtAC4IAC8IADAIADEHADIHADMBAAJpbgEAEkxqYXZhL2xhbmcvU3RyaW5nOwEAA291dAEACG91dF9qc29uAQATW0xqYXZhL2xhbmcvU3RyaW5nOwEABWdldGluAQAUKClMamF2YS9sYW5nL1N0cmluZzsBAARDb2RlAQAPTGluZU51bWJlclRhYmxlAQAFc2V0aW4BABUoTGphdmEvbGFuZy9TdHJpbmc7KVYBAAZnZXRvdXQBAAZzZXRvdXQBAAtnZXRvdXRfanNvbgEAFSgpW0xqYXZhL2xhbmcvU3RyaW5nOwEAC3NldG91dF9qc29uAQAWKFtMamF2YS9sYW5nL1N0cmluZzspVgEABjxpbml0PgEAAygpVgEABmludm9rZQEACkV4Y2VwdGlvbnMHADQBAApTb3VyY2VGaWxlAQAacmVwb3J0X3JvYmVydEphdmFDb2RlLmphdmEMAA4ADwwAEAAPDAARABIMAB8AIAEAAAEAAQoBAAM8cD4HADUMADYANwEAEjwvdGQ+PC90cj48dHI+PHRkPgEAASwBAAk8L3RkPjx0ZD4BADZGcm9udEpTT05VSS9MZXZlbDIvcmVwb3J0X3JvYmVydC9yZXBvcnRfcm9iZXJ0SmF2YUNvZGUBABBqYXZhL2xhbmcvT2JqZWN0AQATamF2YS9sYW5nL0V4Y2VwdGlvbgEAEGphdmEvbGFuZy9TdHJpbmcBAApyZXBsYWNlQWxsAQA4KExqYXZhL2xhbmcvU3RyaW5nO0xqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL1N0cmluZzsAIQAMAA0AAAADAAQADgAPAAAABAAQAA8AAAAEABEAEgAAAAgAAQATABQAAQAVAAAAHQABAAEAAAAFKrQAAbAAAAABABYAAAAGAAEAAAAKAAEAFwAYAAEAFQAAACIAAgACAAAABiortQABsQAAAAEAFgAAAAoAAgAAAA0ABQAOAAEAGQAUAAEAFQAAAB0AAQABAAAABSq0AAKwAAAAAQAWAAAABgABAAAAEAABABoAGAABABUAAAAiAAIAAgAAAAYqK7UAArEAAAABABYAAAAKAAIAAAATAAUAFAABABsAHAABABUAAAAdAAEAAQAAAAUqtAADsAAAAAEAFgAAAAYAAQAAABYAAQAdAB4AAQAVAAAAIgACAAIAAAAGKiu1AAOxAAAAAQAWAAAACgACAAAAGQAFABoAAQAfACAAAQAVAAAAPgACAAEAAAAWKrcABCoSBbUAASoSBbUAAioBtQADsQAAAAEAFgAAABYABQAAABwABAAGAAoABwAQAAgAFQAdAAEAIQAgAAIAFQAAAFIABAABAAAALioqtAABEgYSB7YACLUAAioqtAACEgcSCbYACLUAAioqtAACEgoSC7YACLUAArEAAAABABYAAAASAAQAAAAlAA8AJgAeACcALQAoACIAAAAEAAEAIwABACQAAAACACU=</byteCode>
                </class>
            </byteCode>
        </config>
        <pd:inputBindings>
            <javaCodeActivityInput>
                <in>
                    <xsl:value-of select="$Read-File/ns3:ReadActivityOutputTextClass/fileContent/textContent"/>
                </in>
            </javaCodeActivityInput>
        </pd:inputBindings>
    </pd:activity>
    <pd:activity name="ReportCSS">
        <pd:type>com.tibco.plugin.file.FileReadActivity</pd:type>
        <pd:resourceType>ae.activities.FileReadActivity</pd:resourceType>
        <pd:x>440</pd:x>
        <pd:y>59</pd:y>
        <config>
            <encoding>text</encoding>
        </config>
        <pd:inputBindings>
            <ns1:ReadActivityInputClass>
                <fileName>
                    <xsl:value-of select="&quot;G:\SRAll\AllMayDay\2016-08-26\20161025JSON\MobCastleAD1006RemoteReport_JSON\BakHtml\ReportTableCSS.txt&quot;"/>
                </fileName>
                <encoding>
                    <xsl:value-of select="&quot;UTF-8&quot;"/>
                </encoding>
            </ns1:ReadActivityInputClass>
        </pd:inputBindings>
    </pd:activity>
    <pd:activity name="DownloadReport">
        <pd:type>com.tibco.plugin.file.FileReadActivity</pd:type>
        <pd:resourceType>ae.activities.FileReadActivity</pd:resourceType>
        <pd:x>563</pd:x>
        <pd:y>61</pd:y>
        <config>
            <encoding>text</encoding>
        </config>
        <pd:inputBindings>
            <ns1:ReadActivityInputClass>
                <fileName>
                    <xsl:value-of select="&quot;G:\SRAll\AllMayDay\2016-08-26\20161025JSON\MobCastleAD1006RemoteReport_JSON\BakHtml\TestSaveHTMLByJS.html&quot;"/>
                </fileName>
                <encoding>
                    <xsl:value-of select="&quot;UTF-8&quot;"/>
                </encoding>
            </ns1:ReadActivityInputClass>
        </pd:inputBindings>
    </pd:activity>
    <pd:activity name="ParseCSVData">
        <pd:type>com.tibco.plugin.parse.ParseActivity</pd:type>
        <pd:resourceType>ae.activities.ParseActivity</pd:resourceType>
        <pd:x>84</pd:x>
        <pd:y>304</pd:y>
        <config>
            <InputType>File</InputType>
            <Encoding>UTF8</Encoding>
            <ParseSharedConfig>/FrontJSONUI/Level2/CSVFormat.sharedparse</ParseSharedConfig>
            <SkipBlankLines>true</SkipBlankLines>
            <SpecifyStartRecord>true</SpecifyStartRecord>
        </config>
        <pd:inputBindings>
            <Input>
                <fileName>
                    <xsl:value-of select="&quot;F:\GeekWorkLearn\MyFootPrint\QQFiles\Projects\report_7267443.csv&quot;"/>
                </fileName>
                <startRecord>
                    <xsl:value-of select="2"/>
                </startRecord>
                <noOfRecords>
                    <xsl:value-of select="100"/>
                </noOfRecords>
            </Input>
        </pd:inputBindings>
    </pd:activity>
    <pd:group name="Group">
        <pd:type>com.tibco.pe.core.LoopGroup</pd:type>
        <pd:resourceType>ae.process.group</pd:resourceType>
        <pd:x>221</pd:x>
        <pd:y>247</pd:y>
        <pd:width>640</pd:width>
        <pd:height>149</pd:height>
        <pd:collapsedWidth>57</pd:collapsedWidth>
        <pd:collapsedHeight>70</pd:collapsedHeight>
        <pd:groupVariables/>
        <pd:joinToggle>inherit</pd:joinToggle>
        <config>
            <pd:groupType>inputLoop</pd:groupType>
            <pd:serializable>false</pd:serializable>
            <pd:over>$ParseCSVData/Output/Rows/pfx:reportline_python</pd:over>
            <pd:iterationElementSlot>csvelement</pd:iterationElementSlot>
            <pd:indexSlot>csvindex</pd:indexSlot>
            <pd:outSlot>RepeatLinesResponse</pd:outSlot>
            <pd:activityOutputName>RepeatLines</pd:activityOutputName>
            <pd:accumulateOutput>true</pd:accumulateOutput>
        </config>
        <pd:inputBindings/>
        <pd:expanded>true</pd:expanded>
        <pd:transition>
            <pd:from>start</pd:from>
            <pd:to>GetOfferId_NId</pd:to>
            <pd:lineType>Default</pd:lineType>
            <pd:lineColor>-16777216</pd:lineColor>
            <pd:conditionType>always</pd:conditionType>
        </pd:transition>
        <pd:transition>
            <pd:from>RepeatLines</pd:from>
            <pd:to>end</pd:to>
            <pd:lineType>Default</pd:lineType>
            <pd:lineColor>-16777216</pd:lineColor>
            <pd:conditionType>always</pd:conditionType>
        </pd:transition>
        <pd:transition>
            <pd:from>GetOfferId_NId</pd:from>
            <pd:to>ExtendType</pd:to>
            <pd:lineType>Default</pd:lineType>
            <pd:lineColor>-16777216</pd:lineColor>
            <pd:conditionType>always</pd:conditionType>
        </pd:transition>
        <pd:transition>
            <pd:from>ExtendType</pd:from>
            <pd:to>EarningType</pd:to>
            <pd:lineType>Default</pd:lineType>
            <pd:lineColor>-16777216</pd:lineColor>
            <pd:conditionType>always</pd:conditionType>
        </pd:transition>
        <pd:transition>
            <pd:from>EarningType</pd:from>
            <pd:to>ExtendType_EarningType_Repeat</pd:to>
            <pd:lineType>Default</pd:lineType>
            <pd:lineColor>-16777216</pd:lineColor>
            <pd:conditionType>always</pd:conditionType>
        </pd:transition>
        <pd:transition>
            <pd:from>ExtendType_EarningType_Repeat</pd:from>
            <pd:to>RepeatLines</pd:to>
            <pd:lineType>Default</pd:lineType>
            <pd:lineColor>-16777216</pd:lineColor>
            <pd:conditionType>always</pd:conditionType>
        </pd:transition>
        <pd:activity name="ExtendType">
            <pd:type>com.tibco.pe.core.CallProcessActivity</pd:type>
            <pd:resourceType>ae.process.subprocess</pd:resourceType>
            <pd:x>428</pd:x>
            <pd:y>317</pd:y>
            <config>
                <processName>/FrontJSONUI/Level3/Common_Sql.process</processName>
            </config>
            <pd:inputBindings>
                <root>
                    <sql>
                        <xsl:value-of select="concat(&#xA;&quot;select campaign_expend_t,campaign_expend_c,campaign_expend_n,&quot;,&#xA;&quot;campaign_rm,campaign_id from campaign where offer_id=&quot;,&#xA;$GetOfferId_NId/root/repeatelements/offer_id,&#xA;&quot; and n_id=&quot;,&#xA;$GetOfferId_NId/root/repeatelements/n_id&#xA;)"/>
                    </sql>
                </root>
            </pd:inputBindings>
        </pd:activity>
        <pd:activity name="EarningType">
            <pd:type>com.tibco.pe.core.CallProcessActivity</pd:type>
            <pd:resourceType>ae.process.subprocess</pd:resourceType>
            <pd:x>527</pd:x>
            <pd:y>317</pd:y>
            <config>
                <processName>/FrontJSONUI/Level3/Common_Sql.process</processName>
            </config>
            <pd:inputBindings>
                <root>
                    <sql>
                        <xsl:value-of select="concat(&#xA;&quot;select offer_earning_t,offer_earning_c,offer_earning_n,&quot;,&#xA;&quot;offer_e_expend_t,offer_e_expend_c,offer_e_expend_n,&quot;,&#xA;&quot;offer_id from offer where offer_id=&quot;,&#xA;$GetOfferId_NId/root/repeatelements/offer_id&#xA;)"/>
                    </sql>
                </root>
            </pd:inputBindings>
        </pd:activity>
        <pd:activity name="GetOfferId_NId">
            <pd:type>com.tibco.plugin.mapper.MapperActivity</pd:type>
            <pd:resourceType>ae.activities.MapperActivity</pd:resourceType>
            <pd:x>329</pd:x>
            <pd:y>316</pd:y>
            <config>
                <element>
                    <xsd:element name="root">
                        <xsd:complexType>
                            <xsd:sequence>
                                <xsd:element name="repeatelements" minOccurs="0">
                                    <xsd:complexType>
                                        <xsd:sequence>
                                            <xsd:element name="offer_id" type="xsd:string" minOccurs="0"/>
                                            <xsd:element name="n_id" type="xsd:string" minOccurs="0"/>
                                        </xsd:sequence>
                                    </xsd:complexType>
                                </xsd:element>
                            </xsd:sequence>
                        </xsd:complexType>
                    </xsd:element>
                </element>
            </config>
            <pd:inputBindings>
                <root>
                    <repeatelements>
                        <offer_id>
                            <xsl:value-of select="substring-before($csvelement/pfx:reportline_python/pfx:offer_query, &quot;-&quot;)"/>
                        </offer_id>
                        <n_id>
                            <xsl:value-of select="substring-before($csvelement/pfx:reportline_python/pfx:n_query, &quot;-&quot;)"/>
                        </n_id>
                    </repeatelements>
                </root>
            </pd:inputBindings>
        </pd:activity>
        <pd:activity name="ExtendType_EarningType_Repeat">
            <pd:type>com.tibco.plugin.mapper.MapperActivity</pd:type>
            <pd:resourceType>ae.activities.MapperActivity</pd:resourceType>
            <pd:x>647</pd:x>
            <pd:y>319</pd:y>
            <config>
                <element>
                    <xsd:element name="root">
                        <xsd:complexType>
                            <xsd:sequence>
                                <xsd:element name="extend_type" type="xsd:string" minOccurs="0"/>
                                <xsd:element name="earning_type" type="xsd:string" minOccurs="0"/>
                                <xsd:element name="out_price" type="xsd:string" minOccurs="0"/>
                                <xsd:element name="in_price" type="xsd:string" minOccurs="0"/>
                                <xsd:element name="offer_link" type="xsd:string" minOccurs="0"/>
                                <xsd:element name="n_link" type="xsd:string" minOccurs="0"/>
                            </xsd:sequence>
                        </xsd:complexType>
                    </xsd:element>
                </element>
            </config>
            <pd:inputBindings>
                <root>
                    <extend_type>
                        <xsl:value-of select="concat(&#xA;$ExtendType/unknownResultset[1]/row[1]/column[1]/value,&#xA;&quot;-&quot;,&#xA;$ExtendType/unknownResultset[1]/row[1]/column[2]/value&#xA;)"/>
                    </extend_type>
                    <earning_type>
                        <xsl:value-of select="concat(&#xA;$EarningType/unknownResultset[1]/row[1]/column[1]/value,&#xA;&quot;-&quot;,&#xA;$EarningType/unknownResultset[1]/row[1]/column[2]/value&#xA;)"/>
                    </earning_type>
                    <xsl:if test="$ExtendType/unknownResultset[1]/row[1]/column[3]/value">
                        <out_price>
                            <xsl:value-of select="$ExtendType/unknownResultset[1]/row[1]/column[3]/value"/>
                        </out_price>
                    </xsl:if>
                    <xsl:if test="$EarningType/unknownResultset[1]/row[1]/column[3]/value">
                        <in_price>
                            <xsl:value-of select="$EarningType/unknownResultset[1]/row[1]/column[3]/value"/>
                        </in_price>
                    </xsl:if>
                    <offer_link>
                        <xsl:value-of select="concat(&#xA;if ($_globalVariables/ns2:GlobalVariables/JSONUI/DomainName!=&quot;&quot;) then $_globalVariables/ns2:GlobalVariables/JSONUI/DomainName else &quot;http://91mobcastle.com&quot;,&#xA;&quot;/detail/&quot;,&#xA;&quot;offer&quot;,&#xA;&quot;-detail.html?id=&quot;,&#xA;$GetOfferId_NId/root/repeatelements/offer_id&#xA;)"/>
                    </offer_link>
                    <n_link>
                        <xsl:value-of select="concat(&#xA;if ($_globalVariables/ns2:GlobalVariables/JSONUI/DomainName!=&quot;&quot;) then $_globalVariables/ns2:GlobalVariables/JSONUI/DomainName else &quot;http://91mobcastle.com&quot;,&#xA;&quot;/detail/&quot;,&#xA;&quot;n&quot;,&#xA;&quot;-detail.html?id=&quot;,&#xA;$GetOfferId_NId/root/repeatelements/n_id&#xA;)"/>
                    </n_link>
                </root>
            </pd:inputBindings>
        </pd:activity>
        <pd:activity name="RepeatLines">
            <pd:type>com.tibco.plugin.mapper.MapperActivity</pd:type>
            <pd:resourceType>ae.activities.MapperActivity</pd:resourceType>
            <pd:x>762</pd:x>
            <pd:y>319</pd:y>
            <config>
                <element ref="pfx:reportline"/>
            </config>
            <pd:inputBindings>
                <pfx:reportline>
                    <xsl:if test="$csvelement/pfx:reportline_python/pfx:time">
                        <pfx:time>
                            <xsl:value-of select="$csvelement/pfx:reportline_python/pfx:time"/>
                        </pfx:time>
                    </xsl:if>
                    <xsl:if test="$csvelement/pfx:reportline_python/pfx:offer_query">
                        <pfx:offer_query>
                            <xsl:value-of select="$csvelement/pfx:reportline_python/pfx:offer_query"/>
                        </pfx:offer_query>
                    </xsl:if>
                    <xsl:if test="$ExtendType_EarningType_Repeat/root/offer_link">
                        <pfx:offer_link>
                            <xsl:value-of select="$ExtendType_EarningType_Repeat/root/offer_link"/>
                        </pfx:offer_link>
                    </xsl:if>
                    <xsl:if test="$csvelement/pfx:reportline_python/pfx:n_query">
                        <pfx:n_query>
                            <xsl:value-of select="$csvelement/pfx:reportline_python/pfx:n_query"/>
                        </pfx:n_query>
                    </xsl:if>
                    <xsl:if test="$ExtendType_EarningType_Repeat/root/n_link">
                        <pfx:n_link>
                            <xsl:value-of select="$ExtendType_EarningType_Repeat/root/n_link"/>
                        </pfx:n_link>
                    </xsl:if>
                    <pfx:click>
                        <xsl:value-of select="$csvelement/pfx:reportline_python/pfx:click"/>
                    </pfx:click>
                    <xsl:if test="$csvelement/pfx:reportline_python/pfx:normal">
                        <pfx:normal>
                            <xsl:value-of select="$csvelement/pfx:reportline_python/pfx:normal"/>
                        </pfx:normal>
                    </xsl:if>
                    <pfx:conversionrate>
                        <xsl:value-of select="concat(&#xA;tib:round-fraction(((&#xA;($csvelement/pfx:reportline_python/pfx:normal+$csvelement/pfx:reportline_python/pfx:rm)&#xA;div&#xA;$csvelement/pfx:reportline_python/pfx:click&#xA;)*100)&#xA;,4),&#xA;&quot;%&quot;)"/>
                    </pfx:conversionrate>
                    <xsl:if test="$ExtendType_EarningType_Repeat/root/extend_type">
                        <pfx:campaign_expendtype>
                            <xsl:value-of select="$ExtendType_EarningType_Repeat/root/extend_type"/>
                        </pfx:campaign_expendtype>
                    </xsl:if>
                    <xsl:if test="$ExtendType_EarningType_Repeat/root/out_price">
                        <pfx:out_price>
                            <xsl:value-of select="$ExtendType_EarningType_Repeat/root/out_price"/>
                        </pfx:out_price>
                    </xsl:if>
                    <xsl:if test="$ExtendType_EarningType_Repeat/root/earning_type">
                        <pfx:offer_earningtype>
                            <xsl:value-of select="$ExtendType_EarningType_Repeat/root/earning_type"/>
                        </pfx:offer_earningtype>
                    </xsl:if>
                    <xsl:if test="$ExtendType_EarningType_Repeat/root/in_price">
                        <pfx:in_price>
                            <xsl:value-of select="$ExtendType_EarningType_Repeat/root/in_price"/>
                        </pfx:in_price>
                    </xsl:if>
                    <xsl:if test="$csvelement/pfx:reportline_python/pfx:rm">
                        <pfx:rm>
                            <xsl:value-of select="$csvelement/pfx:reportline_python/pfx:rm"/>
                        </pfx:rm>
                    </xsl:if>
                    <xsl:if test="$csvelement/pfx:reportline_python/pfx:duplicated">
                        <pfx:duplicated>
                            <xsl:value-of select="$csvelement/pfx:reportline_python/pfx:duplicated"/>
                        </pfx:duplicated>
                    </xsl:if>
                </pfx:reportline>
            </pd:inputBindings>
        </pd:activity>
    </pd:group>
    <pd:activity name="JSON_AllResponse">
        <pd:type>com.tibco.plugin.json.activities.JSONRenderActivity</pd:type>
        <pd:resourceType>ae.activities.JSONRenderActivity</pd:resourceType>
        <pd:x>867</pd:x>
        <pd:y>189</pd:y>
        <config>
            <SchemaType>xsdType</SchemaType>
            <BadgerfishCheck>false</BadgerfishCheck>
            <ActivityInputEditor>
                <xsd:element name="root">
                    <xsd:complexType>
                        <xsd:sequence>
                            <xsd:element name="responsestatus" type="xsd:string" minOccurs="0"/>
                            <xsd:element name="reportlink" type="xsd:string" minOccurs="0"/>
                            <xsd:element ref="pfx:reportline" minOccurs="0" maxOccurs="unbounded"/>
                        </xsd:sequence>
                    </xsd:complexType>
                </xsd:element>
            </ActivityInputEditor>
        </config>
        <pd:inputBindings>
            <ns4:ActivityInputClass>
                <root>
                    <responsestatus>
                        <xsl:value-of select="&quot;success&quot;"/>
                    </responsestatus>
                    <reportlink>
                        <xsl:value-of select="concat($_globalVariables/ns2:GlobalVariables/JSONUI/downloadreportink,$Read-File/ns3:ReadActivityOutputTextClass/fileInfo/fullName)"/>
                    </reportlink>
                    <xsl:for-each select="$RepeatLinesResponse/AccumulatedOutput/pfx:reportline">
                        <pfx:reportline>
                            <xsl:if test="pfx:time">
                                <pfx:time>
                                    <xsl:value-of select="pfx:time"/>
                                </pfx:time>
                            </xsl:if>
                            <xsl:if test="pfx:offer_query">
                                <pfx:offer_query>
                                    <xsl:value-of select="pfx:offer_query"/>
                                </pfx:offer_query>
                            </xsl:if>
                            <xsl:if test="pfx:offer_link">
                                <pfx:offer_link>
                                    <xsl:value-of select="pfx:offer_link"/>
                                </pfx:offer_link>
                            </xsl:if>
                            <xsl:if test="pfx:n_query">
                                <pfx:n_query>
                                    <xsl:value-of select="pfx:n_query"/>
                                </pfx:n_query>
                            </xsl:if>
                            <xsl:if test="pfx:n_link">
                                <pfx:n_link>
                                    <xsl:value-of select="pfx:n_link"/>
                                </pfx:n_link>
                            </xsl:if>
                            <xsl:if test="pfx:click">
                                <pfx:click>
                                    <xsl:value-of select="pfx:click"/>
                                </pfx:click>
                            </xsl:if>
                            <xsl:if test="pfx:normal">
                                <pfx:normal>
                                    <xsl:value-of select="pfx:normal"/>
                                </pfx:normal>
                            </xsl:if>
                            <xsl:if test="pfx:conversionrate">
                                <pfx:conversionrate>
                                    <xsl:value-of select="pfx:conversionrate"/>
                                </pfx:conversionrate>
                            </xsl:if>
                            <xsl:if test="pfx:campaign_expendtype">
                                <pfx:campaign_expendtype>
                                    <xsl:value-of select="pfx:campaign_expendtype"/>
                                </pfx:campaign_expendtype>
                            </xsl:if>
                            <xsl:if test="pfx:out_price">
                                <pfx:out_price>
                                    <xsl:value-of select="pfx:out_price"/>
                                </pfx:out_price>
                            </xsl:if>
                            <xsl:if test="pfx:offer_earningtype">
                                <pfx:offer_earningtype>
                                    <xsl:value-of select="pfx:offer_earningtype"/>
                                </pfx:offer_earningtype>
                            </xsl:if>
                            <xsl:if test="pfx:in_price">
                                <pfx:in_price>
                                    <xsl:value-of select="pfx:in_price"/>
                                </pfx:in_price>
                            </xsl:if>
                            <xsl:if test="pfx:rm">
                                <pfx:rm>
                                    <xsl:value-of select="pfx:rm"/>
                                </pfx:rm>
                            </xsl:if>
                            <xsl:if test="pfx:duplicated">
                                <pfx:duplicated>
                                    <xsl:value-of select="pfx:duplicated"/>
                                </pfx:duplicated>
                            </xsl:if>
                        </pfx:reportline>
                    </xsl:for-each>
                </root>
            </ns4:ActivityInputClass>
        </pd:inputBindings>
    </pd:activity>
    <pd:transition>
        <pd:from>Start</pd:from>
        <pd:to>offer_query</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>xpath</pd:conditionType>
        <pd:xpath>1=2</pd:xpath>
    </pd:transition>
    <pd:transition>
        <pd:from>offer_query</pd:from>
        <pd:to>n_query</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>n_query</pd:from>
        <pd:to>SaveConcat</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>SaveConcat</pd:from>
        <pd:to>External Command</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>External Command</pd:from>
        <pd:to>Read File</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>Read File</pd:from>
        <pd:to>Java Code</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>xpath</pd:conditionType>
        <pd:xpath>1="html"</pd:xpath>
    </pd:transition>
    <pd:transition>
        <pd:from>Java Code</pd:from>
        <pd:to>ReportCSS</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>ReportCSS</pd:from>
        <pd:to>DownloadReport</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>DownloadReport</pd:from>
        <pd:to>FormatReportResponse</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>FormatReportResponse</pd:from>
        <pd:to>End</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>Start</pd:from>
        <pd:to>Read File</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>Read File</pd:from>
        <pd:to>ParseCSVData</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>ParseCSVData</pd:from>
        <pd:to>Group</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>Group</pd:from>
        <pd:to>JSON_AllResponse</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>JSON_AllResponse</pd:from>
        <pd:to>End</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
</pd:ProcessDefinition>